<!DOCTYPE html>
<html>

<head>
    <title>Simple Map</title>
    <meta name="viewport" content="initial-scale=1.0">
    <meta charset="utf-8">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASOoy7K9T8QyeA6QysbWUd5-E54b9ZmkU&libraries=places,">
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyASOoy7K9T8QyeA6QysbWUd5-E54b9ZmkU&callback=initMap"
        async defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <style>
        /* Always set the map height explicitly to define the size of the div
       * element that contains the map. */
        #map {
            height: 50%;
            width: 50%;
        }

        /* Optional: Makes the sample page fill the window. */
        html,
        body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <div id="map"></div>
    <div class="container">
        <div class="row">
            <h1>Calculate the distance between two adresses</h1>
            <div class="col-md-6">
                <form id="distance_form">
                    <div class="form-group">
                        <label>origin:</label>
                        <input class="form-control" id="from_places" placeholder="Enter a location" />
                        <input type="hidden" id="origin" name="distination" required />
                    </div>

                    <div class="form-group">
                        <label>Destination:</label>
                        <input class="form-control" id="to_places" placeholder="Enter a location" />
                        <input type="hidden" id="destination" name="distination" required />
                    </div>

                    <input type="submit" value="calculate" class="btn btn-primary" />
                </form>
                <div id="result">
                    <ul id="result">
                        <li class="list-group-item d-flex justify-content-between align-items-center">Distance in Miles:
                            <span id="in_Mile" class="badge badge-primary badge-pill"></span></li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">In text:
                            <span id="duration_text" class="badge badge-primary badge-pill"></span></li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">In Minutes:
                            <span id="duration_value" class="badge badge-primary badge-pill"></span></li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">From:
                            <span id="from" class="badge badge-primary badge-pill"></span></li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">To:
                            <span id="to" class="badge badge-primary badge-pill"></span></li>



                    </ul>

                </div>
            </div>
        </div>

    </div>


    <script>
        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 42.3601, lng: -71.0589 },
                zoom: 13
            });
        }

        // =====================
        // distance
        $(function () {
            //add input listener
            google.maps.event.addDomlistener(window, 'load', function () {
                var from_places = new google.maps.places.Autocomplete(document.getElementById('from_places'));
                var to_places = new google.maps.places.Autocomplete(document.getElementById('to_places'));

                google.maps.event.addListener(from_places, 'place_changed', function () {
                    var from_places = from_places.getplace();
                    var from_address = from_places.formatted.address;
                    $('#origin').val(from_address);
                });

                google.maps.event.addListener(from_places, 'place_changed', function () {
                    var to_places = to_places.getplace();
                    var to_address = to_places.formatted.address;
                    $('#destination').val(to_address);
                });

            });
            // calculate the distance
            function calculatedistance() {
                var origin = $('#origin').val();
                var destination = $('#destination').val();
                var service = new google.maps.DistanceMatrixService();
                service.getDistanceMatrix(
                    {
                        origin: [origin],
                        destination: [destination],
                        travelMode: google.maps.TravelMode.DRIVING,
                        unitsystem: google.maps.UnitSystem.IMPERIAL,
                        avoidHighways: false,
                        avoidTolls: false
                    }, callback);

            }
            // get distance results
            function callback(response, status) {
                var distance = response.rows[0].elements[0].distance;
                var duration = response.rows[0].elements[0].duration;
                var distance_in_Mile = distance.value / 1609.34;
                var duration_text = duration.text;
                var duration_value = duration.value;

                $('#in_mile').text(distance_in_Mile.toFixed(2));
                $('#duration_text').text(duration_text);
                $('#duration_value').text(duration_value);
                $('#from').text(origin);
                $('#to').text(destination);
            }
        })
        // print result on submut the form
        $('#distance_form').submit(function (e) {
            e.preventDefault();
            calculatedistance();
        })






    </script>


</body>

</html>